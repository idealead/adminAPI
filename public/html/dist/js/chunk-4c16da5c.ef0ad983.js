(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c16da5c"],{4364:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"myDesign"},[a("h2",[t._v(" "+t._s(0==t.pageIndex?"未提交":"")+t._s(1==t.pageIndex?"已提交":"")+" "),a("span",[t._v(t._s(t.projectArr.length))])]),a("div",{staticClass:"designArea"},t._l(t.projectArr,(function(e,s){return a("div",{key:e.id,staticClass:"designProject",style:{backgroundImage:"url('"+t.api.images+e.path+"')"},on:{mouseover:function(e){return t.hoverFunc(s)},mouseleave:function(e){return t.outFunc(s)}}},[e.select?a("div",{staticClass:"hoverBlock"},[0==t.pageIndex?a("div",{staticClass:"blockBtn"},[a("div",{staticClass:"designBtn",on:{click:function(a){return t.changeProject(e.id,s)}}},[t._v("修改项目")]),a("div",{staticClass:"designBtn",on:{click:function(a){return t.submit(e.id,s)}}},[t._v("提交审核")]),a("div",{staticClass:"designBtn"},[t._v("删除")])]):t._e(),1==t.pageIndex?a("p",{staticClass:"projectState"},[t._v("审核通过")]):t._e(),1==t.pageIndex?a("div",{staticClass:"blockBtn"},[a("div",{staticClass:"designBtn",on:{click:function(e){return t.showTagFunc(!0,s)}}},[t._v("设置标签")]),a("div",{staticClass:"designBtn",on:{click:function(a){return t.online(e.id,3==e.status?1:3)}}},[t._v(t._s(3==e.status?"上线":"下线"))]),3==e.status?a("div",{staticClass:"designBtn",on:{click:function(a){return t.online(e.id,0)}}},[t._v("撤回提交")]):t._e()]):t._e()]):t._e(),1==t.pageIndex?a("el-badge",{staticClass:"itemNew",attrs:{value:3==e.status?"未上线":"已上线",type:3==e.status?"primary":"success"}}):t._e()],1)})),0),t.showTag?a("div",{staticClass:"alertBg"},[a("div",{staticClass:"alertTag"},[a("div",{staticClass:"theDesign",style:{backgroundImage:"url('"+t.api.images+t.tempData.img+"')"}}),a("div",{staticClass:"theMsg"},[a("div",{staticClass:"msgBlock"},[a("p",[t._v("名称："+t._s(t.tempData.name))]),a("p",[t._v("id："+t._s(t.tempData.id))]),a("p",[t._v("状态："+t._s(t.tempData.status))])])]),a("div",{staticClass:"theTag"},[a("div",{staticClass:"designTagPool"},[a("p",[t._v("模板标签：")]),t._l(t.dynamicTags,(function(e,s){return a("el-tag",{key:e.id,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){return t.handleClose(s)}}},[t._v(t._s(e.answer_t))])}))],2),a("p",{staticClass:"textleft"},[t._v("标签池：")]),a("div",{staticClass:"tagPool"},t._l(t.tagPool,(function(e){return a("el-tag",{key:e[0],staticClass:"selectTag",attrs:{type:"info"},on:{click:function(a){return t.selectTagFunc(e)}}},[t._v(t._s(e[1]))])})),1),a("el-button",{staticClass:"saveBtn",attrs:{type:"primary",round:"",size:"small"},on:{click:t.saveTag}},[t._v("保存")]),a("el-button",{staticClass:"cancelBtn",attrs:{type:"info",round:"",size:"small"},on:{click:function(e){return t.showTagFunc(!1)}}},[t._v("取消")])],1)])]):t._e()])},n=[],i=(a("3acb"),a("536e"),a("c9a0"),a("57d6"),a("82a7"),a("f32a"),a("20a8"),a("9757"),a("69af"),a("9d37")),c=a("08c1"),r=a("0c12"),o=a("2427"),u=a.n(o),l=a("391c"),d=a.n(l);function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var m={name:"myDesign",data:function(){return{pageIndex:0,projectArr:[{img:"",id:"1",select:!1},{img:"",id:"2",select:!1},{img:"",id:"3",select:!1}],tempData:null,showTag:!1,dynamicTags:[[0,"标签一"],[1,"标签一as"],[2,"标签一12wer3"]],inputVisible:!1,inputValue:"",tagPool:[[0,"标签一"],[1,"标签一as"],[2,"标签一12wer3"],[3,"标签一123erter"]]}},computed:g({},Object(c["b"])({user_type:function(t){return t.user.user_type},user_data:function(t){return t.user.user_data},api:function(t){return t.api}})),created:function(){},mounted:function(){var t=this;t.getTempData(0),r["a"].$off("myDesignIndex").$on("myDesignIndex",(function(e){e==t.pageIndex||(t.getTempData(e),t.$set(t,"pageIndex",e))}))},methods:{getTempData:function(t){var e=this,a={user_id:e.user_data.id,status:1==t?"1,3":"".concat(t)};u()({method:"post",url:e.api.template_audit_list,data:a}).then((function(t){if(t=t.data,t.data.length>0){for(var a=t.data,s=[],n=[],i=0;i<a.length;i++)a[i].select=!1,3!=a[i].status&&0!=a[i].status||s.push(a[i]),1==a[i].status&&n.push(a[i]);var c=[].concat(s,n);e.$set(e,"projectArr",c)}else{var r=[];e.$set(e,"projectArr",r)}}))},hoverFunc:function(t){var e=this;e.$set(e["projectArr"][t],"select",!0)},outFunc:function(t){var e=this;e.$set(e["projectArr"][t],"select",!1)},submit:function(t,e){var a=this;u()({method:"post",url:a.api.temp_change_status,data:{id:parseInt(t),status:3,author:a.user_data.id}}).then((function(t){a.projectArr.splice(e,1),a.$message({message:"项目提交成功，请前往“已提交”查看",type:"success"})})).catch((function(){a.$message.error("提交错误请稍后再试")}))},showTagFunc:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=this;t&&(u()({method:"get",url:a.api.find_label_list}).then((function(t){if(t=t.data,t.data.length>0){for(var e=[],s=0;s<t.data.length;s++){var n=[];n.push(parseInt(t.data[s].id)),n.push(t.data[s].answer_t),e.push(n)}a.$set(a,"tagPool",e)}})),a.$set(a,"dynamicTags",a.projectArr[e].label_id),a.$set(a,"tempData",{img:a.projectArr[e].path,name:a.projectArr[e].template_name,id:a.projectArr[e].id,status:1==a.projectArr[e].status?"已上线":"未上线"})),a.$set(a,"showTag",t)},handleClose:function(t){this.dynamicTags.splice(t,1)},selectTagFunc:function(t){var e=this,a=!1;if(e.dynamicTags&&e.dynamicTags.length>0&&(a=e.dynamicTags.some((function(e){return e.id==t[0]}))),!a){var s=d.a.cloneDeep(e.dynamicTags);s instanceof Array||(s=[]),s.push({id:t[0],answer_t:t[1]}),e.$set(e,"dynamicTags",s),s=null}},saveTag:function(){for(var t=this,e=[],a=0;a<t.dynamicTags.length;a++)e.push(parseInt(t.dynamicTags[a].id));u()({method:"post",url:t.api.add_template_label,data:{id:t.tempData.id,label_id:JSON.stringify(e)}}).then((function(e){t.getTempData(t.pageIndex),t.$message({message:"标签保存成功",type:"success"})}))},changeProject:function(t){var e=this;e.$router.push({path:"/canvas?userType=designer&tempId=".concat(parseInt(t))})},online:function(t,e){var a=this;u()({method:"post",url:a.api.complete_template_audit,data:{id:parseInt(t),status:e,author:a.user_data.id}}).then((function(t){1===e?a.$message({message:"项目上线成功",type:"success"}):0===e?a.$message({message:"撤销成功，回到《未提交》",type:"success"}):3===e&&a.$message({message:"下线成功",type:"success"}),a.getTempData(1)})).catch((function(){a.$message.error("提交错误请稍后再试")}))}}},f=m,v=(a("78fc"),a("5511")),h=Object(v["a"])(f,s,n,!1,null,"7b948716",null);e["default"]=h.exports},"78fc":function(t,e,a){"use strict";var s=a("eeae"),n=a.n(s);n.a},eeae:function(t,e,a){}}]);
//# sourceMappingURL=chunk-4c16da5c.ef0ad983.js.map